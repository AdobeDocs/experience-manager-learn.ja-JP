---
title: アセットコンピューティングワーカーとAEM処理プロファイルの統合
description: AEMは、AEM Assets処理プロファイルを介してAdobe I/O Runtimeに導入されたAsset Computeの作業員とCloud Serviceとして統合されます。 処理プロファイルは、カスタムワーカーを使用して特定のアセットを処理し、ワーカーが生成したファイルをアセットレンディションとして保存するようにAuthorサービスで設定されます。
feature: asset-compute, processing-profiles
topics: renditions, development
version: cloud-service
activity: develop
audience: developer
doc-type: tutorial
kt: 6287
thumbnail: KT-6287.jpg
translation-type: tm+mt
source-git-commit: af610f338be4878999e0e9812f1d2a57065d1829
workflow-type: tm+mt
source-wordcount: '778'
ht-degree: 2%

---


# AEM処理プロファイルとの統合

アセット計算ワーカーがAEMでCloud Serviceとしてカスタムレンディションを生成するには、処理プロファイルを介してCloud Service作成者サービスとしてAEMに登録する必要があります。 その処理プロファイルの対象となるすべてのアセットは、アップロードまたは再処理時にワーカーを呼び出し、カスタムレンディションを生成して、アセットのレンディションを介して使用できるようにします。

## 処理プロファイルの定義

最初に、設定可能なパラメーターを持つワーカーを呼び出す新しい処理プロファイルを作成します。

![処理プロファイル](./assets/processing-profiles/new-processing-profile.png)

1. AEM管理者として、Cloud Service作成者サービスとして __AEMにログインします__。 これはチュートリアルなので、開発環境またはサンドボックス内の環境を使用することをお勧めします。
1. __ツール/アセット/処理プロファイルに移動します。__
1. 「 __作成__ 」ボタンをタップします
1. 処理プロファイルに名前を付けます。 `WKND Asset Renditions`
1. 「 __カスタム__ 」タブをタップし、「 __新規」をタップします__
1. 新しいサービスの定義
   + __レンディション名:__ `Circle`
      + AEM Assetsでこのレンディションを識別するために使用されるファイル名レンディション
   + __拡張子：__ `png`
      + 生成されるレンディションの拡張。 をに設定します。ワーカーのWebサービスがサポートしているサポートされている出力形式です。これにより、円の切り取りの後ろに透明な背景が作成されます。 `png`
   + __エンドポイント：__ `https://...adobeioruntime.net/api/v1/web/wkndAemAssetCompute-0.0.1/worker`
      + これは、を介して取得したワーカーのURLで `aio app get-url`す。 URLが、処理プロファイルが設定されるCloud Service環境ーとしてのAEMに基づいて、適切なワークスペースを指していることを確認します。 このサブドメインは、ワークス `development` ペースと一致します。
      + ワーカーURLが正しいワークスペースを指していることを確認します。 AEMをCloud Serviceステージとして使用する場合はステージワークスペースURLを、AEMをCloud Service制作として使用する場合は実稼働ワークスペースURLを使用します。
   + __サービスパラメーター__
      + タップ __追加パラメータ__
         + キー: `size`
         + 値：`1000`
      + タップ __追加パラメータ__
         + キー: `contrast`
         + 値：`0.25`
      + タップ __追加パラメータ__
         + キー: `brightness`
         + 値：`0.10`
      + アセット計算ワーカーに渡され、JavaScriptオブジェクトを介して使用できるこれらのキー/値のペアです。 `rendition.instructions`
   + __MIME タイプ__
      + __以下を含みます。__`image/jpeg`, `image/png`, `image/gif`, `image/bmp`, `image/tiff`
         + ワーカーのWebサービスでサポートされるMIMEタイプは次のみです。これにより、カスタムワーカーで処理できるアセットが制限されます。
      + __除外：__ `Leave blank`
         + このサービス設定を使用して、これらのMIMEタイプを持つアセットを処理しないでください。 この場合、許可リストのみを使用します。
1. 右上の「 __保存__ 」をタップします

## 処理プロファイルの適用と呼び出し

1. 新しく作成された処理プロファイルを選択し、 `WKND Asset Renditions`
1. 上部のアクションバーで ____ 「プロファイルをフォルダに適用」をタップします
1. 「処理」プロファイルを適用するフォルダーを選択し、「 `WKND`__適用」をタップします。例：__
1. 「処理」プロファイルが適用されなかった __AEM/アセット/ファイルを選択して、__ に移動し `WKND`、をタップします。
1. 処理プロファイルが適用されているフォルダーの下の任意のフォルダーに新しい画像アセット([sample-1.jpg](../assets/samples/sample-1.jpg)、 [sample-2.jpg](../assets/samples/sample-2.jpg)、 [sample-3.jpg](../assets/samples/sample-3.jpg))をアップロードし、アップロードしたアセットが処理されるのを待ちます。
1. アセットをタップして詳細を開きます
   + 初期設定のレンディションは、カスタムレンディションよりもAEMでは、より迅速に生成および表示されます。
1. 左側のサイドバーから __レンディション__ 表示を開きます。
1. 名前が付いたアセットをタップし、生成されたレンディション `Circle.png` を確認します

   ![生成されたレンディション](./assets/processing-profiles/rendition.png)

## 完了!

バリデーターがAEMをCloud Service資産計算マイクロサービスとして拡張する方法に関する [チュートリアルは終了です](../overview.md) 。 これで、AEMがCloud Service作成者サービスとして使用するカスタムのAsset Compute Workerを設定、開発、テスト、デバッグおよびデプロイする機能が必要になります。

### Githubの完全なプロジェクトソースコードを確認します。

最終的なアセット計算プロジェクトは、次の場所でGithubで利用できます。

+ [aem-guides-wknd-asset-compute](https://github.com/adobe/aem-guides-wknd-asset-compute)

_Githubにはプロジェクトの最後の状態が含まれ、ワーカーとテストケースが完全に入力されますが、資格情報は含まれません。`.env`,`.config.json`または`.aio`._

## トラブルシューティング

### アセットにカスタムレンディションが見つかりません

+ __エラー：__ 新しく再処理されたアセットは正常に処理されますが、カスタムレンディションが見つかりません。

#### 処理プロファイルが上位フォルダーに適用されていません

+ __原因：__ カスタムワーカーを使用する処理プロファイルを含むフォルダーの下にアセットが存在しません
+ __解像度：__ 処理プロファイルのアセットの上位フォルダーへの適用

#### 低い処理プロファイルで置き換えられた処理プロファイル

+ __原因：__ このアセットは、カスタムワーカーの処理プロファイルが適用されたフォルダーの下に存在しますが、そのカスタマーワーカーを使用しない別の処理プロファイルが、そのフォルダーとアセットの間で適用されています。
+ __解像度：__ 2つの処理プロファイルを組み合わせて、または調整し、中間処理プロファイルを削除する

### アセットの処理に失敗しました

+ __エラー：__ アセットに表示されるアセット処理に失敗したバッジ
+ __原因：__ カスタムワーカーの実行中にエラーが発生しました
+ __解像度：__ を使用したAdobe I/O Runtimeアクティベーションの [デバッグに関する手順に従い](../test-debug/debug.md#aio-app-logs)`aio app logs`ます。
