---
title: コンテンツフラグメントの作成 | AEM ヘッドレス OpenAPI パート 2
description: Adobe Experience Manager（AEM）と OpenAPI の概要 コンテンツフラグメントモデルに基づいて、新しいコンテンツフラグメントを作成し、編集します。コンテンツフラグメントのバリエーションを作成する方法について説明します。
version: Experience Manager as a Cloud Service
mini-toc-levels: 1
jira: KT-6713
thumbnail: 22451.jpg
feature: Content Fragments
topic: Headless, Content Management
role: Developer
level: Beginner
duration: 700
source-git-commit: 01f51a3556cfbcc22bbe31c4c05c11caaab71708
workflow-type: tm+mt
source-wordcount: '1274'
ht-degree: 11%

---

# コンテンツフラグメントの作成

この章では、[&#x200B; チームおよび人物コンテンツフラグメントモデル &#x200B;](./1-content-fragment-models.md) に基づいて、新しいコンテンツフラグメントを作成し、編集します。 これらのコンテンツフラグメントは、OpenAPI を使用したAEM コンテンツフラグメント配信を使用して React アプリで消費されるコンテンツになります。

## 前提条件

これは複数の部で構成されるチュートリアルで、「[コンテンツフラグメントモデルの定義](./1-content-fragment-models.md)」でまとめられている手順が完了していることを前提としています。

## 目的

* コンテンツフラグメントモデルに基づいてコンテンツフラグメントを作成します。
* コンテンツフラグメントを作成します。
* コンテンツフラグメントを公開します。

## コンテンツフラグメント用のアセットフォルダーの作成

コンテンツフラグメントは、AEM Assets のフォルダーに保存されます。前の章で作成したコンテンツフラグメントモデルからコンテンツフラグメントを作成するには、コンテンツフラグメントを保存するフォルダーが存在する必要があります。 特定のコンテンツフラグメントモデルからコンテンツフラグメントを作成できるようにするには、フォルダーで設定が必要です。

AEMは、「フラットな」フォルダー編成をサポートしています。つまり、様々なコンテンツフラグメントモデルのコンテンツフラグメントが 1 つのフォルダーに混在しています。 ただし、このチュートリアルでは、コンテンツフラグメントモデルに適合するフォルダー構造を使用して、**次の章** の [&#x200B; フォルダーごとにすべてのコンテンツフラグメントをリスト表示 &#x200B;](./3-explore-openapis.md) API を調べます。 コンテンツフラグメントの組織を決める際には、コンテンツフラグメントの作成および管理方法と、OpenAPI を使用してAEM コンテンツフラグメント配信を介して配信および使用する方法の両方を検討します。

1. AEM スタート画面で、**アセット**／**ファイル**&#x200B;に移動します。
1. 右上隅の「**作成**」を選択し、「**フォルダー**」を選択します。 次を入力 :

   * タイトル：**マイプロジェクト**
   * 名前：**my-project**

   「**作成**」を選択してフォルダーを作成します。

1. 新しい **My Project** フォルダーを開き、新しい **My Project** フォルダーの下に次の値でサブフォルダーを作成します。

   * タイトル：**English**
   * 名前：**en**

   AEMのネイティブローカライゼーション機能をサポートするために、プロジェクトを配置するルート言語フォルダーが作成されます。 今日ローカライゼーションを必要としない場合でも、多言語サポート用のプロジェクトを設定することをお勧めします。 [詳しくは、次の文書のページ](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/content/assets/admin/translate-assets.html?lang=ja)を参照してください。

1. 次の値を持つ 2 つのサブフォルダーを新しい **My Project/English** フォルダーに作成します。

   `teams` チーム **コンテンツフラグメントを含む** フォルダー

   * タイトル：**Teams**
   * 名前：**teams**

   ...および `people` ユーザー **コンテンツフラグメントを含む** フォルダー。

   * タイトル：**People**
   * 名前：**people**

1. **My Project/英語** フォルダーに戻り、2 つの新しいフォルダーが作成されていることを確認します。
1. **チーム** フォルダーを選択し、上部のアクションバーで **プロパティ** を選択します。
1. 「**ポリシー**」タブを選択し、「**から継承`/content/dam/my-project`** のチェックを外します。
1. 「**ポリシー**」タブの「**許可されているコンテンツフラグメントモデル （パス別**」フィールドで、**チーム** コンテンツフラグメントモデルを選択します。

   ![許可されているコンテンツフラグメントモデル](assets/2/folder-policies.png)

   これらのポリシーは、サブフォルダーに自動的に継承されますが、上書きできます。 コンテンツフラグメントモデルは、タグで許可することも、他のプロジェクト設定のコンテンツフラグメントモデルを有効にすることもできます。 このメカニズムにより、コンテンツ階層を強力に管理できます。

1. **保存して閉じる** を選択して、フォルダーのプロパティの変更を保存します。
1. 同じ方法で **People** フォルダーの **ポリシー** を更新しますが、代わりに **Person** コンテンツフラグメントモデルを選択します。

## ユーザーコンテンツフラグメントの作成

**マイプロジェクト/英語/人物** フォルダーの **人物** コンテンツフラグメントモデルに基づいて、コンテンツフラグメントを作成します。

1. AEM スタート画面で「**コンテンツフラグメント**」を選択して、コンテンツフラグメントコンソールを開きます。
1. **フォルダーを表示** ボタンを選択して、フォルダーブラウザーを開きます。
1. **My Project/英語/人物** フォルダーを選択します。
1. **作成/コンテンツフラグメント** を選択し、次の値を入力します。

   * 場所：`/content/dam/my-project/en/people`
   * コンテンツフラグメントモデル：**人物**
   * タイトル：**John Doe**
   * 名前：`john-doe`

   **新しいコンテンツフラグメント** ダイアログの **タイトル**、**名前**、**説明** の各フィールドは、コンテンツフラグメントのデータの一部ではなく、コンテンツフラグメントに関するメタデータとして保存されることに注意してください。

   ![新しいコンテンツフラグメント](assets/2/new-content-fragment.png)

1. 「**作成して開く**」を選択します。
1. **John Doe** フラグメントのフィールドに入力します。

   * 氏名：**John Doe**
   * Biography: **John Doe はソーシャルメディアと旅行愛好家が大好きです。**
   * プロファイル画像：`/content/dam` から画像を選択するか、新しい画像をアップロードします。
   * 職業：**インフルエンサー**、**旅行者**

   これらのフィールドと値は、OpenAPI を使用したAEM コンテンツフラグメント配信で使用されるコンテンツフラグメントのコンテンツを定義します。

   ![&#x200B; 新しいコンテンツフラグメントのオーサリング &#x200B;](assets/2/john-doe-content-fragment.png)

1. コンテンツフラグメントの変更は自動的に保存されるので、「**保存** ボタンはありません。
1. コンテンツフラグメントコンソールに戻り、**マイプロジェクト/英語/人物** を選択して、新しいコンテンツフラグメントを表示します。

### 追加のユーザーコンテンツフラグメントを作成する

上記の手順を繰り返して、追加の **Person** フラグメントを作成します。

1. 次のプロパティを持つ **Alison Smith** 用の Person コンテンツフラグメントを作成します。

   * 場所：`/content/dam/my-project/en/people`
   * コンテンツフラグメントモデル：**人物**
   * タイトル：**Alison Smith**
   * 名前：`alison-smith`

   **作成して開く** を選択し、次の値を作成します。

   * フルネーム：**Alison Smith**
   * Biography: **アリソンは写真家で、旅の記事を書くのが大好き**
   * プロファイル画像：`/content/dam` から画像を選択するか、新しい画像をアップロードします。
   * 職業：**写真家**、**旅行者**、**作家**

これで、**マイプロジェクト/英語/人物** フォルダーに 2 つのコンテンツフラグメントが作成されました。

![新規コンテンツフラグメント](assets/2/people-content-fragments.png)

オプションで、追加の人物を表すユーザーコンテンツフラグメントをさらに作成できます。

## チームコンテンツフラグメントの作成

同じ方法で、**My Project/English/Teams** フォルダーの **Team** コンテンツフラグメントモデルに基づいて **Team** フラグメントを作成します。

1. 次のプロパティを使用して **チーム** Alpha **を表す** チーム」フラグメントを作成します。

   * 場所：`/content/dam/my-project/en`
   * コンテンツフラグメントモデル：**チーム**
   * タイトル：**チームアルファ**
   * 名前：`team-alpha`

   **作成して開く** を選択し、次の値を作成します。

   * タイトル：**チームアルファ**
   * 説明：**チームAlphaは、写真とトラベルライティングを専門とするトラベルコンテンツチームです。**
   * **チームメンバー**:「**John Doe**」コンテンツフラグメントと「**Alison Smith** コンテンツフラグメントを選択して、「**チームメンバー**」フィールドに入力します。

   ![Team Alpha コンテンツフラグメント &#x200B;](assets/2/team-alpha-content-fragment.png)

1. **作成して開く** を選択して、Team コンテンツフラグメントを作成します
1. **マイプロジェクト/英語/チーム** の下に 1 つのコンテンツフラグメントがあるはずです。

これで、**My Project/English/Teams** フォルダーに **Team Alpha** コンテンツフラグメントが作成されました。

![&#x200B; チームコンテンツフラグメント &#x200B;](assets/2/team-content-fragments.png)

必要に応じて、別のユーザーのセットで **チームオメガ** を作成します。

## コンテンツフラグメントの公開

コンテンツフラグメントを OpenAPI で使用できるようにするには、コンテンツフラグメントを公開します。 公開すると、コンテンツフラグメントに次からアクセスできます。

* **パブリッシュサービス** - コンテンツを実稼動アプリケーションに提供します。
* **プレビューサービス** - アプリケーションをプレビューするコンテンツを提供します。

通常、コンテンツはまず **プレビューサービス** に公開され、プレビューアプリケーションでレビューされてから **パブリッシュサービス** に公開されます。 **パブリッシュサービス** に公開しても、**プレビューサービス** には公開されません。 **プレビューサービス** に別途公開する必要があります。

このチュートリアルでは、AEM パブリッシュサービスに公開しますが、AEM プレビューサービスを使用するのは、React アプリで [AEM サービスの URL を変更するのと同じくらい簡単 &#x200B;](./4-react-app.md) す。

1. コンテンツフラグメントコンソールで、**マイプロジェクト/英語** フォルダーを見つけます。
1. **英語** フォルダーですべてのコンテンツフラグメントを選択し（すべてのサブフォルダーのすべてのコンテンツフラグメントが表示されます）、上部のアクションバーから **公開/今すぐ** を選択します。

   ![&#x200B; 公開するコンテンツフラグメントを選択する &#x200B;](assets/2/select-publish-content-fragments.png)

1. **すべての参照を含める** で **パブリッシュサービス** を選択し、**非公開** および **変更** を選択してから **公開** を選択します。

   ![コンテンツフラグメントの公開](assets/2/publish-content-fragments.png)

これで、コンテンツフラグメント、チームコンテンツフラグメントで参照されるすべての Person コンテンツフラグメント、参照されるすべてのアセットが、**パブリッシュサービス** に公開されます。

**プレビューサービス** にも同じように公開できます。

## おめでとうございます。

これで、AEMのコンテンツフラグメントモデルに基づいて、コンテンツフラグメントを正常に作成しました。 **ユーザー** コンテンツフラグメントモデルを作成し、複数の **ユーザー** コンテンツフラグメントを作成し、複数の **ユーザー** コンテンツフラグメントを参照する **チーム** コンテンツフラグメントを作成しました。

コンテンツフラグメントが公開されると、OpenAPI を使用してAEM コンテンツフラグメント配信を通じてコンテンツフラグメントにアクセスできるようになります。

## 次の手順

次の章の [OpenAPI について &#x200B;](3-explore-openapis.md) では、API ドキュメントに組み込まれている **試す** 機能を使用して、OpenAPI を使用したAEM コンテンツフラグメント配信について説明します。

