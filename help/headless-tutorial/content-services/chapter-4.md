---
title: 第 4 章 - コンテンツサービステンプレートの定義 - コンテンツサービス
description: AEM ヘッドレスチュートリアルの第 4 章では、AEM コンテンツサービスのコンテキストにおける AEM の編集可能テンプレートの役割について説明します。編集可能テンプレートは、最終的に開示される AEM コンテンツサービスの JSON コンテンツの構造を定義するために使用されます。
feature: Content Fragments, APIs
topic: Headless, Content Management
role: Developer
level: Beginner
doc-type: Tutorial
exl-id: ece0bf0d-c4af-4962-9c00-f2849c2d8f6f
duration: 301
source-git-commit: af928e60410022f12207082467d3bd9b818af59d
workflow-type: tm+mt
source-wordcount: '778'
ht-degree: 100%

---

# 第 4 章 - コンテンツサービステンプレートの定義

AEM ヘッドレスチュートリアルの第 4 章では、AEM コンテンツサービスのコンテキストにおける AEM の編集可能テンプレートの役割について説明します。編集可能テンプレートは、コンテンツサービスを有効化した AEM コンポーネントの構成を通じて、AEM コンテンツサービスがクライアントに開示する JSON コンテンツの構造を定義するために使用されます。

## AEM コンテンツサービスのテンプレートの役割について

AEM の編集可能テンプレートを使用して、イベントコンテンツを JSON として開示するためにアクセスされる HTTP エンドポイントを定義します。

従来、AEM の編集可能テンプレートは web ページを定義するために使用されていましたが、この使い方は単なる慣例に過ぎません。編集可能テンプレートを使用すると、**任意の**&#x200B;一連のコンテンツを作成できます。そのコンテンツがどのようにアクセスされるかは、ブラウザーで HTML として、JavaScript（AEM SPA エディター）またはモバイルアプリで消費される JSON としてなど、そのページがリクエストされる方法によって異なります。

AEM コンテンツサービスでは、編集可能テンプレートを使用して、JSON データの開示方法を定義します。

[!DNL WKND Mobile] アプリでは、単一の API エンドポイントを駆動するために使用される単一の編集可能テンプレートを作成します。この例では AEM ヘッドレスの概念を簡単に説明しますが、異なる一連のコンテンツを開示する複数のページ（またはエンドポイント）を作成すると、より複雑で整理された API を作成できます。

## API エンドポイントについて

API エンドポイントの構成を理解し、どのコンテンツを [!DNL WKND Mobile] アプリに開示する必要があるかを理解するために、設計をもう一度見てみましょう。

![Events API ページの分解](./assets/chapter-4/design-to-component-mapping.png)

このように、モバイルアプリに提供するコンテンツの論理セットは 3 つあります。

1. **ロゴ**
2. **タグライン**
3. **イベント**&#x200B;リスト

これを行うには、これらの要件を AEM コンポーネント（この場合は AEM WCM コアコンポーネント）にマッピングして、必要なコンテンツを JSON として開示します。

1. **ロゴ**&#x200B;は&#x200B;**画像コンポーネント**&#x200B;を介して表示されます。
2. **タグライン**&#x200B;は&#x200B;**テキストコンポーネント**&#x200B;を介して表示されます。
3. **イベント**&#x200B;リストは、一連のイベントコンテンツフラグメントを参照する&#x200B;**コンテンツフラグメントリストのコンポーネント**&#x200B;を介して表示されます。

>[!NOTE]
>
>AEM コンテンツサービスでページとコンポーネントが JSON エクスポートに対応するには、ページとコンポーネントが **AEM WCM コアコンポーネントから派生**&#x200B;している必要があります。
>
>[AEM WCM コアコンポーネント](https://github.com/Adobe-Marketing-Cloud/aem-core-wcm-components)には、書き出したページとコンポーネントの正規化された JSON スキーマをサポートする機能が組み込まれています。このチュートリアルで使用するすべての WKND Mobile コンポーネント（ページ、画像、テキスト、コンテンツフラグメントリスト）は、AEM WCM コアコンポーネントから派生したものです。

## Events API テンプレートの定義

1. **[!UICONTROL ツール]／[!UICONTROL 一般]／[!UICONTROL テンプレート]／[!DNL WKND Mobile]** に移動します。

1. **[!DNL Events API]** テンプレートを作成します。

   1. 上部のアクションバーで「**[!UICONTROL 作成]**」をタップします。
   1. **[!DNL WKND Mobile - Empty Page]** テンプレートを選択します。
   1. 上部のアクションバーで「**[!UICONTROL 次へ]**」をタップします。
   1. 「[!UICONTROL テンプレートのタイトル]」フィールドに **[!DNL Events API]** を入力します。
   1. 上部のアクションバーで「**[!UICONTROL 作成]**」をタップします。
   1. 「**[!UICONTROL 開く]**」をタップして編集用の新しいテンプレートを開きます。

1. まず、ルートの[!UICONTROL レイアウトコンテナ]の[!UICONTROL ポリシー]を編集して、コンテンツをモデル化するために必要な 3 つの特定された AEM コンポーネントを許可します。**[!UICONTROL 構造]**&#x200B;モードがアクティブであることを確認し、**[!DNL Layout Container \[Root\]]** を選択して「**[!UICONTROL ポリシー]**」ボタンをタップします。
1. **[!UICONTROL プロパティ]／[!UICONTROL 許可されたコンポーネント]**&#x200B;で **[!DNL WKND Mobile]** を検索します。[!DNL Events] API ページで使用できるように、[!DNL WKND Mobile] コンポーネントグループから次のコンポーネントを許可します。

   * **[!DNL WKND Mobile > Image]**

      * アプリのロゴ

   * **[!DNL WKND Mobile > Text]**

      * アプリの紹介テキスト

   * **[!DNL WKND Mobile > Content Fragment List]**

      * アプリで表示できるイベントカテゴリのリスト

1. 完了したら、右上隅にある「**[!UICONTROL 完了]**」チェックマークをタップします。
1. ブラウザーウィンドウを&#x200B;**更新**&#x200B;して、新しく[!UICONTROL 許可されたコンポーネント]のリストを左側のパネルに表示します。
1. 左側のパネルのコンポーネントファインダーから、次の AEM コンポーネントにドラッグします。
   1. ロゴ用 **[!DNL Image]**
   2. タグライン用 **[!DNL Text]**
   3. イベント用 **[!DNL Content Fragment List]**
1. **上記の各コンポーネント**&#x200B;について、それらを選択して「**ロック解除**」ボタンを押します。
1. ただし、他のコンポーネントが追加されたり、これら 3 つのコンポーネントが削除されたりしないよう、**レイアウトコンテナ** が **ロック**&#x200B;されていることを確認してください。
1. **[!UICONTROL ページ情報]／[!UICONTROL 管理画面で表示]**&#x200B;をタップして、[!DNL WKND Mobile] テンプレートリストに戻ります。新しく作成した **[!DNL Events API]** テンプレートを選択し、上部のアクションバーで「**[!UICONTROL 有効にする]**」をタップします。

>[!VIDEO](https://video.tv.adobe.com/v/28342?quality=12&learn=on)

>[!NOTE]
>
> コンテンツの表示に使用されるコンポーネントがテンプレート自体に追加され、ロックされていることに注意してください。 これは、作成者が事前定義されたコンポーネントを編集できるようにするためですが、API 自体を変更すると、JSON 構造に関する前提が崩れ、消費するアプリが壊れる可能性があるため、コンポーネントを任意に追加または削除することはできません。すべての API は安定している必要があります。

## 次の手順

必要に応じて、[com.adobe.aem.guides.wknd-mobile.content.chapter-4.zip](https://github.com/adobe/aem-guides-wknd-mobile/releases/latest) コンテンツパッケージを [AEM のパッケージ マネージャー](http://localhost:4502/crx/packmgr/index.jsp)経由で AEM オーサーにインストールします。このパッケージには、チュートリアルのこの章および前の章で概要を説明する設定とコンテンツが含まれています。

* [第 5 章 - コンテンツサービスページのオーサリング](./chapter-5.md)
